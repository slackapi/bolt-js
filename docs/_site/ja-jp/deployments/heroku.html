<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" >
  
    <title>Slack | Bolt for JavaScript</title>
    <meta name="author" content="Slack">
    <meta name="description" content="A framework that makes Slack app development fast and straight-forward. With a single interface for Slack’s Web API, Events API, and interactive features, Bolt gives you the full power of the Slack platform out of the box.">
    <link rel="canonical" href="http://localhost:4000/bolt-js/ja-jp/deployments/heroku">
    <link href="https://a.slack-edge.com/17c88/style/rollup-slack_kit_legacy_adapters.css" rel="stylesheet" type="text/css">
    <link href="https://a.slack-edge.com/cc5205/style/rollup-api_site.css" rel="stylesheet" type="text/css">
    
      <link href="https://fonts.googleapis.com/css?family=Noto+Sans+JP:400,700&display=swap" rel="stylesheet">
    
    <link href="http://localhost:4000/bolt-js/assets/style.css" rel="stylesheet" type="text/css">
  
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    

    <!--[if lt IE 9]>
    <script src="https://a.slack-edge.com/ef0d/js/libs/html5shiv.js"></script>
    <![endif]-->
  
    <link id="favicon" rel="shortcut icon" href="http://localhost:4000/bolt-js/assets/bolt-favicon.png" sizes="16x16 32x32 48x48" type="image/png" />
  
  </head>


<body>
  <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KFZ5MK7');</script>
<!-- End Google Tag Manager -->

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KFZ5MK7" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

  <div class="wrapper">
    <div class="panel">
      <div class="sidebar-content">
  <div class="logo">
    <span class="icon">
      <img src="http://localhost:4000/bolt-js/assets/bolt-js-logo.svg">
    </span>

    <span class="name">
      Bolt
    </span>

    <!-- Liquid has no ternary operator, so this is just meant to exclude 
      english sections since they are at the root URL -->
    

    <span class="version">
      
      <a href="https://github.com/slackapi/bolt-js/releases/tag/%40slack/bolt%403.18.0">v3.18.0</a>
    </span>
  </div>

  <ul class="sidebar-section">
    <a href="http://localhost:4000/bolt-js/ja-jp/tutorial/getting-started"><li class="title">Bolt 入門ガイド</li></a>
    <a href="http://localhost:4000/bolt-js/ja-jp/reference"><li class="title">リファレンス</li></a>
  </ul>

  <ul class="sidebar-section">
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#basic"><li class="title">基本的な概念</li></a>
     
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#message-listening">
      <li>メッセージ・イベントのリスニング</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#message-sending">
      <li>メッセージの送信</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#event-listening">
      <li>イベントのリスニング</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#web-api">
      <li>Web API の使用</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#action-listening">
      <li>アクションのリスニング</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#action-respond">
      <li>アクションへの応答</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#acknowledge">
      <li>リクエストの確認</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#shortcuts">
      <li>ショートカットのリスニング</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#commands">
      <li>コマンドのリスニングと応答</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#creating-modals">
      <li>モーダルの開始</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#updating-pushing-views">
      <li>モーダルの更新と多重表示</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#view-submissions">
      <li>モーダルでの送信のリスニング</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#publishing-views">
      <li>ホームタブの更新</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#options">
      <li>オプションのリスニングと応答</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#authenticating-oauth">
      <li>OAuth フローの実装</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#socket-mode">
      <li>ソケットモードの使用</li>
    </a>
    
  </ul>

  <ul class="sidebar-section">
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#advanced">
      <li class="title">応用コンセプト</li>
    </a>
     
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#error-handling">
      <li>エラーの処理</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#authorization">
      <li>認可（Authorization）</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#token-rotation">
      <li>トークンのローテーション</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#conversation-store">
      <li>会話ストア</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#global-middleware">
      <li>グローバルミドルウェア</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#listener-middleware">
      <li>リスナーミドルウェア</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#context">
      <li>context の追加</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#logging">
      <li>ログの表示</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#receiver">
      <li>レシーバーのカスタマイズ</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#custom-routes">
      <li>カスタム HTTP ルートの追加</li>
    </a>
    
  </ul>

  
  
    <ul class="sidebar-section"> 
        <li class="title">Deployments</li>
      
        <a href="http://localhost:4000/bolt-js/ja-jp/deployments/aws-lambda">
          <li>AWS Lambda へのデプロイ</li>
        </a>
      
        <a href="http://localhost:4000/bolt-js/ja-jp/deployments/heroku">
          <li>Heroku へのデプロイ</li>
        </a>
      
    </ul>
  

  <ul class="sidebar-section">
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#steps">
      <li class="title">
        ワークフローステップ
        <span class="label-deprecated">
          非推奨
        </span>
      </li>
    </a>
     
      
    
      
      <a href="http://localhost:4000/bolt-js/ja-jp/concepts#creating-steps">
        
        <!--UNCOMMENT AFTER GA  -->
        <li>
          ステップの定義
        </li>
      </a>
      
    
      
      <a href="http://localhost:4000/bolt-js/ja-jp/concepts#adding-editing-steps">
        
        <!--UNCOMMENT AFTER GA  -->
        <li>
          ステップの追加・編集
        </li>
      </a>
      
    
      
      <a href="http://localhost:4000/bolt-js/ja-jp/concepts#saving-steps">
        
        <!--UNCOMMENT AFTER GA  -->
        <li>
          ステップの設定の保存
        </li>
      </a>
      
    
      
      <a href="http://localhost:4000/bolt-js/ja-jp/concepts#executing-steps">
        
        <!--UNCOMMENT AFTER GA  -->
        <li>
          ステップの実行
        </li>
      </a>
      
    
  </ul>

  <ul class="sidebar-section">
    
    
    <a href="http://localhost:4000/bolt-js/ja-jp/tutorial/getting-started-http">
      <li class="title">Bolt 入門ガイド (HTTP)</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/tutorial/hubot-migration">
      <li class="title">Hubot から Bolt に移行する方法</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/tutorial/migration-v2">
      <li class="title">2.x マイグレーションガイド</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/tutorial/migration-v3">
      <li class="title">3.x マイグレーションガイド</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/tutorial/using-typescript">
      <li class="title">TypeScript での利用ガイド</li>
    </a>
    
    <a href="https://github.com/SlackAPI/bolt-js/blob/main/.github/contributing.md">
      <li class="title">貢献</li>
    </a>
  </ul>
</div>

    </div>


    <div class="content">
        <div class="mainheader">
          <div class="header">
  <div class="header_nav">
    <a href="https://github.com/SlackAPI/bolt-js" class="btn header_btn float_right"><ts-icon class="ts_icon_github"></ts-icon>Code on GitHub</a>
    <a href="https://api.slack.com" class="btn header_btn float_right"><ts-icon class="ts_icon_slack_pillow"></ts-icon>Slack Platform Home</a>
    <!-- If we add more languages, this logic will need to change -->
    
      <a href="http://localhost:4000/bolt-js/" class="header_btn language-switcher float_right">English</a>
    
    </div>
</div>
        </div>

        <div class="tutorial-nav">
          <ul class="tutorial-nav-list"></ul>
        </div>
        
        <div class="tutorial">
          <h1 id="heroku-へのデプロイ">Heroku へのデプロイ</h1>

<div class="section-content">
  <p>このガイドでは、<a href="/bolt-js/ja-jp">Bolt for JavaScript</a>と<a href="https://heroku.com/">Heroku プラットフォーム</a>を使ってSlack アプリを用意して、デプロイするまでの手順を説明します。全体の流れとしては、Bolt Slack アプリをダウンロードし、Heroku 用の準備を済ませ、デプロイする流れになります。</p>
</div>

<p>この手順を全て終わらせたら、あなたはきっと️⚡️<a href="https://github.com/slackapi/bolt-js/tree/main/examples/deploy-heroku">getting-started-with-heroku</a>のサンプルアプリを動作させたり、それに変更を加えたり、自分のアプリを作ったりすることができるようになるでしょう。</p>

<hr>

<h3 id="get-a-bolt-slack-app">Bolt Slack アプリを入手する</h3>

<p>Bolt アプリを作るのが初めてという場合は、まず<a href="/bolt-js/ja-jp/tutorial/getting-started">Bolt 入門ガイド</a>に沿って進めてみましょう。または、以下のテンプレートアプリをクローンしてもよいでしょう。</p>

<div class="language-shell highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
</pre></td>
<td class="rouge-code"><pre>git clone https://github.com/slackapi/bolt-js-getting-started-app.git
</pre></td>
</tr></tbody></table></code></pre>
  </div>
</div>

<p>ダウンロードしたBolt アプリのディレクトリに移動します。</p>

<div class="language-shell highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
</pre></td>
<td class="rouge-code"><pre><span class="nb">cd </span>bolt-js-getting-started-app/
</pre></td>
</tr></tbody></table></code></pre>
  </div>
</div>

<p>次に、このアプリをHeroku で動かすための準備をします。</p>

<hr>

<h3 id="prepare-the-app-for-heroku">アプリをHeroku で動かすための準備する</h3>

<p>Heroku は、作ったアプリをホストできる柔軟性の高いプラットフォームで、少し設定が必要です。このセクションでは、Bolt アプリに変更を加え、Heroku に対応させます。</p>

<p><strong>1. Git リポジトリを使用する</strong></p>

<p>Heroku にアプリをデプロイするには、まずGit リポジトリが必要です。まだGit を使ったことがない場合は、<a href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git">Git をインストール</a>し、<a href="https://git-scm.com/book/en/v2/Git-Basics-Getting-a-Git-Repository">Git リポジトリを作成</a>します</p>

<blockquote>
  <p>💡 前のセクションで<code class="language-plaintext highlighter-rouge">git clone</code>を使用した場合、Git リポジトリはすでに存在しますので、この手順はスキップできます</p>
</blockquote>

<p><strong>2. Procfile を追加する</strong></p>

<p>Heroku アプリでは、必ず<code class="language-plaintext highlighter-rouge">Procfile</code>という専用のファイルが必要です。このファイルを使ってHeroku にアプリの起動方法を伝えます。Bolt Slack アプリは、公開されたWeb アドレスを持つWeb サーバーとして起動します。</p>

<p>アプリのルートディレクトリに、拡張子なしの<code class="language-plaintext highlighter-rouge">Procfile</code>という名前のファイルを作成し、次の内容を貼りつけます。内容はどのようにアプリを動かすかによって変わります。</p>

<p>デフォルトでは Bolt アプリは公開された Web アドレスを持つ Web サーバーとして起動するので、以下のように指定します：</p>

<div class="language-yaml highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
</pre></td>
<td class="rouge-code"><pre><span class="na">web</span><span class="pi">:</span> <span class="s">node app.js</span>
</pre></td>
</tr></tbody></table></code></pre>
  </div>
</div>

<p>ソケットモードを使ったアプリをデプロイするときは、ポートをリッスンしない worker として起動します：</p>

<div class="language-yaml highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
</pre></td>
<td class="rouge-code"><pre><span class="na">worker</span><span class="pi">:</span> <span class="s">node app.js</span>
</pre></td>
</tr></tbody></table></code></pre>
  </div>
</div>

<p>ファイルを保存したら、ローカルのGit リポジトリにコミットします。</p>

<div class="language-shell highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td>
<td class="rouge-code"><pre>git add Procfile
git commit <span class="nt">-m</span> <span class="s2">"Add Procfile"</span>
</pre></td>
</tr></tbody></table></code></pre>
  </div>
</div>

<blockquote>
  <p>💡 既存のBolt アプリを使ってこのガイドに沿って進めている場合は、<a href="https://devcenter.heroku.com/articles/preparing-a-codebase-for-heroku-deployment#4-listen-on-the-correct-port">Preparing a Codebase for Heroku Deployment</a>のガイドを参考に、適切なポートをリッスンするようにしてください。</p>
</blockquote>

<hr>

<h3 id="set-up-the-heroku-tools">Heroku ツールをセットアップする</h3>

<p>ローカルマシンでHeroku ツールのセットアップを行います。このツールは、Heroku プラットフォームを使用するアプリの管理、デプロイ、デバッグを行う場合に便利です。</p>

<p><strong>1. Heroku CLI をインストールする</strong></p>

<p>Heroku ツールは、コマンドラインインターフェイス（CLI）の形で提供されています。さっそく<a href="https://devcenter.heroku.com/articles/getting-started-with-nodejs#set-up">macOS、Windows、Linux 用のHeroku CLI</a>をインストールしましょう。macOS では次のコマンドを実行します。</p>

<div class="language-shell highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
</pre></td>
<td class="rouge-code"><pre>brew <span class="nb">install </span>heroku/brew/heroku
</pre></td>
</tr></tbody></table></code></pre>
  </div>
</div>

<p>インストールが完了したら、Heroku CLI を試してみましょう。どのようなコマンドが使えるかを一覧表示してみます。</p>

<div class="language-shell highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
</pre></td>
<td class="rouge-code"><pre>heroku <span class="nb">help</span>
</pre></td>
</tr></tbody></table></code></pre>
  </div>
</div>

<blockquote>
  <p>💡 <code class="language-plaintext highlighter-rouge">heroku</code>コマンドが見つからない場合は、パスを更新するため新しいターミナルセッションまたはターミナルタブを開いてください。</p>
</blockquote>

<p><strong>2. Heroku CLI にログインする</strong></p>

<p>Heroku CLI では、ローカルマシンからHeroku アカウントに接続します。<a href="https://heroku.com">無料のHeroku アカウントを新規登録</a>して、次のコマンドでHeroku CLI にログインします。</p>

<div class="language-shell highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
</pre></td>
<td class="rouge-code"><pre>heroku login
</pre></td>
</tr></tbody></table></code></pre>
  </div>
</div>
<blockquote>
  <p>💡 ファイアウォールを使っている場合、Heroku CLI で使用される<a href="https://devcenter.heroku.com/articles/using-the-cli#using-an-http-proxy">プロキシ環境変数</a>の設定が必要なことがあります。</p>
</blockquote>

<p><strong>3. Heroku CLI へのログインが成功したか確認する</strong></p>

<p>ログインできたかどうか確認しましょう。次のコマンドを実行すると、Heroku CLI に現在接続されているアカウント名が表示されます。</p>

<div class="language-shell highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
</pre></td>
<td class="rouge-code"><pre>heroku auth:whoami
</pre></td>
</tr></tbody></table></code></pre>
  </div>
</div>

<p>これでHeroku ツールのセットアップが完了しました。それではHeroku アプリの作成の本編に進みましょう。</p>

<hr>

<h3 id="create-an-app-on-heroku">Heroku アプリを作成する</h3>

<p>先ほどインストールしたツールを使って、<a href="https://devcenter.heroku.com/articles/creating-apps">Heroku アプリを作成</a>します。アプリを作成するときは、ユニークな名前を自分で指定するか、ランダムな名前を生成することができます。</p>

<blockquote>
  <p>💡 <a href="https://devcenter.heroku.com/articles/renaming-apps">Heroku アプリはあとから名前を変更することもできます</a>が、リモートのGit アドレスとパブリックのWeb アドレスも変更になります。</p>
</blockquote>

<p><strong>1. Heroku アプリを作成する</strong></p>

<p>ユニークな名前を指定してHeroku アプリを作成します。</p>

<div class="language-shell highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
</pre></td>
<td class="rouge-code"><pre>heroku create my-unique-bolt-app-name
</pre></td>
</tr></tbody></table></code></pre>
  </div>
</div>

<p>または、ランダムな名前を楽しむならこちらで。</p>

<div class="language-shell highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td>
<td class="rouge-code"><pre>heroku create
<span class="c"># Creating sharp-rain-871... done, stack is heroku-18</span>
<span class="c"># https://sharp-rain-871.herokuapp.com/ | https://git.heroku.com/sharp-rain-871.git</span>
</pre></td>
</tr></tbody></table></code></pre>
  </div>
</div>

<p>Heroku アプリが作成されると、いくつかの情報が表示されます。これらの情報は次のセクションで使用します。この例では、次のようになります。</p>

<ul>
  <li>アプリ名: <code class="language-plaintext highlighter-rouge">sharp-rain-871</code>
</li>
  <li>Web アドレス: <code class="language-plaintext highlighter-rouge">https://sharp-rain-871.herokuapp.com/</code>
</li>
  <li>空のリモートGit リポジトリ: <code class="language-plaintext highlighter-rouge">https://git.heroku.com/sharp-rain-871.git</code>
</li>
</ul>

<p><strong>2. Heroku のリモートGit リポジトリを確認する</strong></p>

<p>Heroku CLI は、自動的に<code class="language-plaintext highlighter-rouge">heroku</code>という名前のリモートGit リポジトリをローカルに追加します。リモートGit リポジトリを一覧して、<code class="language-plaintext highlighter-rouge">heroku</code>が存在することを確認しましょう。</p>

<div class="language-shell highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td>
<td class="rouge-code"><pre>git remote <span class="nt">-v</span>
<span class="c"># heroku	https://git.heroku.com/sharp-rain-871.git (fetch)</span>
<span class="c"># heroku	https://git.heroku.com/sharp-rain-871.git (push)</span>
</pre></td>
</tr></tbody></table></code></pre>
  </div>
</div>

<p><strong>3. アプリをデプロイする</strong></p>

<p>Slack アプリの認証情報をHeroku アプリに設定します。</p>

<div class="language-shell highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td>
<td class="rouge-code"><pre>heroku config:set <span class="nv">SLACK_SIGNING_SECRET</span><span class="o">=</span>&lt;your-signing-secret&gt;
heroku config:set <span class="nv">SLACK_BOT_TOKEN</span><span class="o">=</span>xoxb-&lt;your-bot-token&gt;
</pre></td>
</tr></tbody></table></code></pre>
  </div>
</div>

<blockquote>
  <p>💡 認証情報の入手場所がわからない場合、Bolt 入門ガイドで<a href="/bolt-js/ja-jp/tutorial/getting-started#%E3%83%88%E3%83%BC%E3%82%AF%E3%83%B3%E3%81%A8%E3%82%A2%E3%83%97%E3%83%AA%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB">署名シークレットとトークンのエクスポート</a>について参照してください。</p>
</blockquote>

<p>ローカルでのアプリの準備と、Heroku アプリの作成が完了しました。次のステップは、デプロイです。</p>

<hr>

<h3 id="deploy-the-app">アプリをデプロイする</h3>

<p>アプリをデプロイするため、ローカルのコードをHeroku にプッシュします。その後Slack アプリの設定を更新し、Heroku アプリに”hello” と声をかけてみましょう。 ✨</p>

<p><strong>1. Heroku にアプリをデプロイする</strong></p>

<p>Heroku へのアプリのデプロイには、通常<code class="language-plaintext highlighter-rouge">git push</code>コマンドを使用します。これにより、ローカルリポジトリのコードがリモートの<code class="language-plaintext highlighter-rouge">heroku</code>リポジトリにプッシュされます。</p>

<p>次のコマンドでアプリをデプロイしましょう。</p>

<div class="language-shell highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
</pre></td>
<td class="rouge-code"><pre>git push heroku main
</pre></td>
</tr></tbody></table></code></pre>
  </div>
</div>
<p>Heroku でデプロイされるのは、<a href="https://devcenter.heroku.com/articles/git-branches">master またはmain ブランチ</a>のコードです。それ以外のブランチにプッシュした場合、デプロイ処理はトリガーされません</p>

<blockquote>
  <p>💡 Heroku deploys code that’s pushed to the <a href="https://devcenter.heroku.com/articles/git-branches">master or main branches</a>. Pushing to other branches will not trigger a deployment.</p>
</blockquote>

<p>最後に、Heroku CLI を使ってWeb サーバーインスタンスを起動します。</p>

<div class="language-shell highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
</pre></td>
<td class="rouge-code"><pre>heroku ps:scale <span class="nv">web</span><span class="o">=</span>1
</pre></td>
</tr></tbody></table></code></pre>
  </div>
</div>

<p><strong>2. Slack アプリの設定を更新する</strong></p>

<p>次に、Heroku のWeb アドレスをリクエストURL に指定し、Slack からのイベントやアクションがこのURL に送信されるようにします。</p>

<p>次のコマンドを使ってHeroku のWeb アドレスを取得します。</p>

<div class="language-shell highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td>
<td class="rouge-code"><pre>heroku info
<span class="c"># ...</span>
<span class="c"># Web URL: https://sharp-rain-871.herokuapp.com/</span>
</pre></td>
</tr></tbody></table></code></pre>
  </div>
</div>

<p>この例では、<code class="language-plaintext highlighter-rouge">https://sharp-rain-871.herokuapp.com/</code>がWeb アドレスとなります。</p>

<p><a href="https://api.slack.com/apps">Slack アプリのページ</a>を開き、アプリ名を選択します。次に、リクエストURLを自分で確認したWeb アドレスに変更します。設定する場所は2 か所あります。</p>

<blockquote>
  <p>💡 リクエストURL の末尾は<code class="language-plaintext highlighter-rouge">/slack/events</code>です。例えば<code class="language-plaintext highlighter-rouge">https://sharp-rain-871.herokuapp.com/slack/events</code>のようになります。</p>
</blockquote>

<p>つ目の場所は、サイドパネルの「<strong>Interactivity &amp; Shortcuts</strong>」です。これを選択し、リクエスト<strong>URLを</strong>更新します。</p>

<p><img src="../../assets/interactivity-and-shortcuts-page.png" alt="Interactivity &amp; Shortcuts page" title="Interactivity &amp; Shortcuts"></p>

<p>2 つ目の場所は、サイドパネルの「<strong>Event Subscriptions</strong>」です。これを選択し、リクエスト<strong>URLを</strong>更新します。</p>

<p><img src="../../assets/event-subscriptions-page.png" alt="Event Subscriptions page" title="Event Subscriptions"></p>

<blockquote>
  <p>💡 無料プランで使用するHeroku アプリは、非アクティブな状態が続くとスリープします。💤 認証が失敗した場合、すぐに再試行してみてください。</p>
</blockquote>

<p><strong>3. Slack アプリをテストする</strong></p>

<p>アプリのデプロイが完了し、Slack の設定変更も行いました。アプリを試してみましょう。</p>

<p>アプリが参加しているSlack チャンネルを開き、半角の小文字で”hello” と書き込みます。<a href="/bolt-js/ja-jp/tutorial/getting-started#%E3%82%A2%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E9%80%81%E4%BF%A1%E3%81%A8%E5%BF%9C%E7%AD%94">Bolt 入門ガイド</a>のとおり、アプリから応答があるはずです。応答がない場合、リクエスト<strong>URLを</strong>確認し、もう一度試してください。</p>

<hr>

<h3 id="deploy-an-update">変更をデプロイする</h3>

<p>Slack アプリを構築するなかで、変更を加えてデプロイする必要があります。一般的な流れでは、変更を加え、コミットし、Heroku にプッシュするという順番です。</p>

<p>この流れをつかむため、アプリが”goodbye” というメッセージに応答するように変更を加えてみましょう。次のコードを<code class="language-plaintext highlighter-rouge">app.js</code> に追加します（<a href="https://github.com/slackapi/bolt-js/blob/main/examples/deploy-heroku/app.js">GitHub のソースコードはこちら</a>）。</p>

<div class="language-javascript highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td>
<td class="rouge-code"><pre><span class="c1">// "goodbye" が含まれるメッセージの着信をリッスン</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">message</span><span class="p">(</span><span class="dl">'</span><span class="s1">goodbye</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">({</span> <span class="nx">message</span><span class="p">,</span> <span class="nx">say</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// say() で、イベントがトリガーされたチャンネルにメッセージを送信する</span>
  <span class="k">await</span> <span class="nx">say</span><span class="p">(</span><span class="s2">`See ya later, &lt;@</span><span class="p">${</span><span class="nx">message</span><span class="p">.</span><span class="nx">user</span><span class="p">}</span><span class="s2">&gt; :wave:`</span><span class="p">);</span>
<span class="p">});</span>
</pre></td>
</tr></tbody></table></code></pre>
  </div>
</div>

<p>変更内容をローカルのGit リポジトリにコミットします。</p>

<div class="language-shell highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
</pre></td>
<td class="rouge-code"><pre>git commit <span class="nt">-am</span> <span class="s2">"ユーザーに'goodbye' を返す"</span>
</pre></td>
</tr></tbody></table></code></pre>
  </div>
</div>

<p>変更内容をリモートのherokuリポジトリにプッシュし、デプロイします。</p>

<div class="language-shell highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
</pre></td>
<td class="rouge-code"><pre>git push heroku main
</pre></td>
</tr></tbody></table></code></pre>
  </div>
</div>

<p>デプロイ処理が完了したら、アプリが参加しているSlack チャンネルを開き、半角の小文字で”goodbye” と書き込みます。Slack アプリから、さよならの挨拶が返ってくるはずです。</p>

<hr>

<h3 id="next-steps">次のステップ</h3>

<p>これではじめて️⚡Bolt for JavaScript アプリをHerokuへデプロイすることに成功しました。🚀</p>

<p>基本的なアプリのデプロイができましたので、次はアプリのカスタマイズやモニタリングを行う方法を調べてみましょう。おすすめのステップをいくつか紹介します。</p>

<ul>
  <li>
<a href="https://devcenter.heroku.com/articles/how-heroku-works">How Heroku Works</a>を読んでHeroku の動作の理解を深めたり、<a href="https://devcenter.heroku.com/articles/free-dyno-hours">Heroku アプリを無料で使う場合の制限</a>をチェックしたりする。</li>
  <li>
<a href="/bolt-js/ja-jp/concepts#basic">Bolt の基本的な概念</a>を参考にしてアプリを拡張したり、<a href="https://elements.heroku.com/addons">Heroku Add-ons</a>をアプリに取り入れたりする</li>
  <li>
<a href="/bolt-js/ja-jp/concepts#advanced">Bolt の応用コンセプト</a>でログの表示について学習し、<a href="https://devcenter.heroku.com/articles/getting-started-with-nodejs#view-logs">Heroku でのログメッセージの確認方法</a>を把握する。</li>
  <li>
<a href="https://devcenter.heroku.com/articles/getting-started-with-nodejs#scale-the-app">Heroku アプリのスケール方法</a>に従って、アクセスの増加に対処する。</li>
</ul>


        </div>
    </div>

  </div>
  <script src="http://localhost:4000/bolt-js/scripts/tutorial_nav.js"></script>

  
<script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-56978219-13', 'auto');
  ga('send', 'pageview');
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>

</body>
</html>