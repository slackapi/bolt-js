<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" >
  
    <title>Slack | Bolt for JavaScript</title>
    <meta name="author" content="Slack">
    <meta name="description" content="A framework that makes Slack app development fast and straight-forward. With a single interface for Slack’s Web API, Events API, and interactive features, Bolt gives you the full power of the Slack platform out of the box.">
    <link rel="canonical" href="http://localhost:4000/bolt-js/ja-jp/tutorial/getting-started-http">
    <link href="https://a.slack-edge.com/17c88/style/rollup-slack_kit_legacy_adapters.css" rel="stylesheet" type="text/css">
    <link href="https://a.slack-edge.com/cc5205/style/rollup-api_site.css" rel="stylesheet" type="text/css">
    
      <link href="https://fonts.googleapis.com/css?family=Noto+Sans+JP:400,700&display=swap" rel="stylesheet">
    
    <link href="http://localhost:4000/bolt-js/assets/style.css" rel="stylesheet" type="text/css">
  
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    

    <!--[if lt IE 9]>
    <script src="https://a.slack-edge.com/ef0d/js/libs/html5shiv.js"></script>
    <![endif]-->
  
    <link id="favicon" rel="shortcut icon" href="http://localhost:4000/bolt-js/assets/bolt-favicon.png" sizes="16x16 32x32 48x48" type="image/png" />
  
  </head>


<body>
  <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KFZ5MK7');</script>
<!-- End Google Tag Manager -->

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KFZ5MK7" 
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

  <div class="wrapper">
    <div class="panel">
      <div class="sidebar-content">
  <div class="logo">
    <span class="icon">
      <img src="http://localhost:4000/bolt-js/assets/bolt-js-logo.svg" />
    </span>

    <span class="name">
      Bolt
    </span>

    <!-- Liquid has no ternary operator, so this is just meant to exclude 
      english sections since they are at the root URL -->
    

    <span class="version">
      
      <a href="https://github.com/slackapi/bolt-js/releases/tag/%40slack/bolt%403.18.0">v3.18.0</a>
    </span>
  </div>

  <ul class="sidebar-section">
    <a href="http://localhost:4000/bolt-js/ja-jp/tutorial/getting-started"
      ><li class="title">Bolt 入門ガイド</li></a
    >
    <a href="http://localhost:4000/bolt-js/ja-jp/reference"
      ><li class="title">リファレンス</li></a
    >
  </ul>

  <ul class="sidebar-section">
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#basic"
      ><li class="title">基本的な概念</li></a
    >
     
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#message-listening">
      <li>メッセージ・イベントのリスニング</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#message-sending">
      <li>メッセージの送信</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#event-listening">
      <li>イベントのリスニング</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#web-api">
      <li>Web API の使用</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#action-listening">
      <li>アクションのリスニング</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#action-respond">
      <li>アクションへの応答</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#acknowledge">
      <li>リクエストの確認</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#shortcuts">
      <li>ショートカットのリスニング</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#commands">
      <li>コマンドのリスニングと応答</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#creating-modals">
      <li>モーダルの開始</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#updating-pushing-views">
      <li>モーダルの更新と多重表示</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#view-submissions">
      <li>モーダルでの送信のリスニング</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#publishing-views">
      <li>ホームタブの更新</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#options">
      <li>オプションのリスニングと応答</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#authenticating-oauth">
      <li>OAuth フローの実装</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#socket-mode">
      <li>ソケットモードの使用</li>
    </a>
    
  </ul>

  <ul class="sidebar-section">
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#advanced">
      <li class="title">応用コンセプト</li>
    </a>
     
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#error-handling">
      <li>エラーの処理</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#authorization">
      <li>認可（Authorization）</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#token-rotation">
      <li>トークンのローテーション</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#conversation-store">
      <li>会話ストア</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#global-middleware">
      <li>グローバルミドルウェア</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#listener-middleware">
      <li>リスナーミドルウェア</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#context">
      <li>context の追加</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#logging">
      <li>ログの表示</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#receiver">
      <li>レシーバーのカスタマイズ</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#custom-routes">
      <li>カスタム HTTP ルートの追加</li>
    </a>
    
  </ul>

  
  
    <ul class="sidebar-section"> 
        <li class="title">Deployments</li>
      
        <a href="http://localhost:4000/bolt-js/ja-jp/deployments/aws-lambda">
          <li>AWS Lambda へのデプロイ</li>
        </a>
      
        <a href="http://localhost:4000/bolt-js/ja-jp/deployments/heroku">
          <li>Heroku へのデプロイ</li>
        </a>
      
    </ul>
  

  <ul class="sidebar-section">
    <a href="http://localhost:4000/bolt-js/ja-jp/concepts#steps">
      <li class="title">
        ワークフローステップ
        <span class="label-deprecated">
          非推奨
        </span>
      </li>
    </a>
     
      
    
      
      <a href="http://localhost:4000/bolt-js/ja-jp/concepts#creating-steps">
        
        <!--UNCOMMENT AFTER GA  -->
        <li>
          ステップの定義
        </li>
      </a>
      
    
      
      <a href="http://localhost:4000/bolt-js/ja-jp/concepts#adding-editing-steps">
        
        <!--UNCOMMENT AFTER GA  -->
        <li>
          ステップの追加・編集
        </li>
      </a>
      
    
      
      <a href="http://localhost:4000/bolt-js/ja-jp/concepts#saving-steps">
        
        <!--UNCOMMENT AFTER GA  -->
        <li>
          ステップの設定の保存
        </li>
      </a>
      
    
      
      <a href="http://localhost:4000/bolt-js/ja-jp/concepts#executing-steps">
        
        <!--UNCOMMENT AFTER GA  -->
        <li>
          ステップの実行
        </li>
      </a>
      
    
  </ul>

  <ul class="sidebar-section">
    
    
    <a href="http://localhost:4000/bolt-js/ja-jp/tutorial/getting-started-http">
      <li class="title">Bolt 入門ガイド (HTTP)</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/tutorial/hubot-migration">
      <li class="title">Hubot から Bolt に移行する方法</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/tutorial/migration-v2">
      <li class="title">2.x マイグレーションガイド</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/tutorial/migration-v3">
      <li class="title">3.x マイグレーションガイド</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/ja-jp/tutorial/using-typescript">
      <li class="title">TypeScript での利用ガイド</li>
    </a>
    
    <a href="https://github.com/SlackAPI/bolt-js/blob/main/.github/contributing.md">
      <li class="title">貢献</li>
    </a>
  </ul>
</div>

    </div>


    <div class="content">
        <div class="mainheader">
          <div class="header">
  <div class="header_nav">
    <a href="https://github.com/SlackAPI/bolt-js" class="btn header_btn float_right"><ts-icon class="ts_icon_github"></ts-icon>Code on GitHub</a>
    <a href="https://api.slack.com" class="btn header_btn float_right"><ts-icon class="ts_icon_slack_pillow"></ts-icon>Slack Platform Home</a>
    <!-- If we add more languages, this logic will need to change -->
    
      <a href="http://localhost:4000/bolt-js/" class="header_btn language-switcher float_right">English</a>
    
    </div>
</div>
        </div>

        <div class="tutorial-nav">
          <ul class="tutorial-nav-list"></ul>
        </div>
        
        <div class="tutorial">
          <h1 id="bolt-入門ガイド-http">Bolt 入門ガイド (HTTP)</h1>

<div class="section-content">
  <p>このガイドでは、Bolt を使用して Slack アプリを起動し実行する方法について説明します。その過程で、新しい Slack アプリを作成し、ローカル環境を設定し、Slack ワークスペースからのメッセージをリッスンして応答するアプリを開発します。</p>
</div>

<p>このガイドが終わったら、あなたはこの⚡️<a href="https://github.com/slackapi/bolt-js-getting-started-app">Getting Started app</a>を実行したり、修正したり、自分で作ったりすることができます。</p>

<hr />

<h3 id="create-an-app">アプリを作成する</h3>
<p>最初にやるべきこと: Bolt で開発を始める前に、 <a href="https://api.slack.com/apps/new">Slack アプリを作成</a>します。</p>

<blockquote>
  <p>💡 いつもの仕事のさまたげにならないように、別に開発用のワークスペースを使用することをおすすめします — <a href="https://slack.com/get-started#create">新しいワークスペースを無料で作成</a>できます。</p>
</blockquote>

<p>アプリ名を入力し (後で変更可能)、インストール先のワークスペースを選択したら、<code class="language-plaintext highlighter-rouge">Create App</code>  ボタンをクリックすると、アプリの  <strong>Basic Information</strong>  ページが表示されます。</p>

<p>このページには、後で必要になる重要な認証情報 (<strong>App Credentials</strong>  ヘッダーの下の  <code class="language-plaintext highlighter-rouge">Signing Secret</code>  など) に加えて、アプリケーションの概要が表示されます。</p>

<p><img src="../../assets/basic-information-page.png" alt="Basic Information page" title="Basic Information page" /></p>

<p>ひと通り確認し、アプリのアイコンと説明を追加してから、アプリの設定 🔩 を始めましょう。</p>

<hr />

<h3 id="tokens-and-installing-apps">トークンとアプリのインストール</h3>
<p>Slack アプリは、<a href="https://api.slack.com/docs/oauth">OAuth を使用して、Slack の API へのアクセスを管理</a>します。アプリがインストールされると、トークンを受け取ります。そのトークンを使って、アプリは API メソッドを呼び出すことができます。</p>

<p>Slack アプリで使用できるトークンには、ユーザートークン（<code class="language-plaintext highlighter-rouge">xoxp</code>）とボットトークン（<code class="language-plaintext highlighter-rouge">xoxb</code>）、アプリレベルトークン（<code class="language-plaintext highlighter-rouge">xapp</code>）の 3 種類があります。</p>
<ul>
  <li><a href="https://api.slack.com/authentication/token-types#user">ユーザートークン</a> を使用すると、アプリをインストールまたは認証したユーザーに成り代わって API メソッドを呼び出すことができます。1 つのワークスペースに複数のユーザートークンが存在する可能性があります。</li>
  <li><a href="https://api.slack.com/authentication/token-types#bot">ボットトークン</a> はボットユーザーに関連づけられ、1 つのワークスペースでは最初に誰かがそのアプリをインストールした際に一度だけ発行されます。どのユーザーがインストールを実行しても、アプリが使用するボットトークンは同じになります。 <em>ほとんど</em> のアプリで使用されるのは、ボットトークンです。</li>
  <li><a href="https://api.slack.com/authentication/token-types#app">アプリレベルトークン</a> は、全ての組織（とその配下のワークスペースでの個々のユーザーによるインストール）を横断して、あなたのアプリを代理するものです。アプリレベルトークンは、アプリの WebSocket コネクションを確立するためによく使われます。</li>
</ul>

<p>説明を簡潔にするために、このガイドではボットトークンを使用します。</p>

<ol>
  <li>
    <p>左側のサイドバーの <strong>OAuth &amp; Permissions</strong> にアクセスして、<strong>Bot Token Scopes</strong> までスクロールします。そして、<strong>Add an OAuth Scope</strong> をクリックします。</p>
  </li>
  <li>
    <p>とりあえずは、<a href="https://api.slack.com/scopes/chat:write"><code class="language-plaintext highlighter-rouge">chat:write</code></a> というスコープだけを追加してみましょう。これは、アプリにボットユーザがメンバーとして参加しているチャンネルへのメッセージの投稿を許可するスコープです。</p>
  </li>
  <li>
    <p>ページ上部までスクロールして戻り、<strong>Install App to Workspace</strong> をクリックします。すると、開発用のワークスペースにこのアプリをインストールするための Slack の OAuth 確認画面へと誘導されます。</p>
  </li>
  <li>
    <p>インストールを承認すると、<strong>OAuth &amp; Permissions</strong> ページが表示され、<strong>Bot User OAuth Access Token</strong> を確認することができるはずです。</p>
  </li>
</ol>

<p><img src="../../assets/bot-token.png" alt="OAuth Tokens" title="OAuth Tokens" /></p>

<blockquote>
  <p>💡 トークンは、パスワードのように大切に扱い、<a href="https://api.slack.com/docs/oauth-safety">安全に保管</a>してください。アプリではそのトークンを使用して、Slack ワークスペースからの情報を投稿および取得します。</p>
</blockquote>

<hr />

<h3 id="setting-up-your-project">ローカルプロジェクトの設定</h3>
<p>初期設定が完了したので、次は新しい Bolt プロジェクトを設定します。ここで、アプリのロジックを処理するコードを記述します。</p>

<p>プロジェクトをまだ作成していない場合は、新しいプロジェクトを作成しましょう。次のように、空のディレクトリを作成して、新しいプロジェクトを初期化します。</p>

<div class="language-shell highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nb">mkdir </span>first-bolt-app
<span class="nb">cd </span>first-bolt-app
npm init
</pre></td></tr></tbody></table></code></pre>
  </div>
</div>

<p>新しいプロジェクトを説明するための一連の質問が表示されます (特に問題がなければ、各プロンプトで <kbd>Enter</kbd> を押すと、デフォルトを受け入れることができます)。完了すると、ディレクトリ内に新しい <code class="language-plaintext highlighter-rouge">package.json</code> ファイルが作成されます。</p>

<p>Bolt パッケージを新しいプロジェクトにインストールする前に、アプリの設定時に生成されたボットトークンと signing secret (サイン認証) を保存しましょう。これらは環境変数として保存する必要があります。<strong>バージョン管理では保存しない</strong>でください。</p>

<ol>
  <li><strong>Basic Information ページから Signing Secret をコピー</strong>して、新しい環境変数に保存します。次の例は Linux と macOS で動作します。ただし、<a href="https://superuser.com/questions/212150/how-to-set-env-variable-in-windows-cmd-line/212153#212153">Windows でも同様のコマンドが利用可能</a>です。
    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">SLACK_SIGNING_SECRET</span><span class="o">=</span>&lt;your-signing-secret&gt;
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li><strong>OAuth &amp; Permissions ページからボット (xoxb) トークンをコピー</strong>し、それを別の環境変数に格納します。
    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">SLACK_BOT_TOKEN</span><span class="o">=</span>xoxb-&lt;your-bot-token&gt;
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ol>

<p>それでは、アプリを作成しましょう。次のコマンドを使用して、<code class="language-plaintext highlighter-rouge">@slack/bolt</code> パッケージをインストールし、 <code class="language-plaintext highlighter-rouge">package.json</code> 中で依存ファイルとして保存します。</p>

<div class="language-shell highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>npm <span class="nb">install</span> @slack/bolt
</pre></td></tr></tbody></table></code></pre>
  </div>
</div>

<p>このディレクトリ内に <code class="language-plaintext highlighter-rouge">app.js</code> という名前の新しいファイルを作成し、以下のコードを追加します。</p>

<div class="language-javascript highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="kd">const</span> <span class="p">{</span> <span class="nx">App</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">@slack/bolt</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// ボットトークンとソケットモードハンドラーを使ってアプリを初期化します</span>
<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">App</span><span class="p">({</span>
  <span class="na">token</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SLACK_BOT_TOKEN</span><span class="p">,</span>
  <span class="na">signingSecret</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SLACK_SIGNING_SECRET</span>
<span class="p">});</span>

<span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// アプリを起動します</span>
  <span class="k">await</span> <span class="nx">app</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">PORT</span> <span class="o">||</span> <span class="mi">3000</span><span class="p">);</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">⚡️ Bolt app is running!</span><span class="dl">'</span><span class="p">);</span>
<span class="p">})();</span>
</pre></td></tr></tbody></table></code></pre>
  </div>
</div>

<p>まず実行してみましょう。 <code class="language-plaintext highlighter-rouge">app.js</code> ファイルを保存してから、以下のコマンドラインで動かします。</p>

<pre><code class="language-script">node app.js
</code></pre>

<p>アプリから、起動し実行中であることが通知されます🎉</p>

<hr />

<h3 id="setting-up-events-with-http">イベントの設定 (HTTP)</h3>
<p>アプリはボットとしてチームメンバーのように動作し、メッセージを投稿したり、絵文字リアクションを追加したりすることができます。</p>

<p>Slack ワークスペースで発生するイベント (メッセージが投稿されたときや、メッセージに対するリアクションが投稿されたときなど) をリッスンするには、<a href="https://api.slack.com/events-api">Events API を使用してイベントタイプに登録</a>します。</p>

<p>アプリのイベントを有効にしましょう。</p>

<ol>
  <li>
    <p>アプリのイベントを有効にするには、まずアプリ設定ページに戻ります (<a href="https://api.slack.com/apps">アプリ管理ページ</a>でアプリをクリックします)。左側のサイドバーにある  <strong>Event Subscription</strong>  をクリックします。<strong>Enable Events</strong>  のスイッチをオンにします。</p>
  </li>
  <li>
    <p>Request URLを追加します。Slackはイベントに対応するHTTP POSTリクエストをこの<a href="https://api.slack.com/apis/connections/events-api#the-events-api__subscribing-to-event-types__events-api-request-urls">Request URL</a>エンドポイントに送信します。Boltは<code class="language-plaintext highlighter-rouge">/slack/events</code>のパスを使用して、すべての受信リクエスト（ショートカット、イベント、インタラクティビティのペイロードなど）をリッスンします。アプリの設定でRequest URLを設定する際には、<code class="language-plaintext highlighter-rouge">https://&lt;your-domain&gt;/slack/events</code>のように<code class="language-plaintext highlighter-rouge">/slack/events</code>を追加します。💡</p>
  </li>
</ol>

<blockquote>
  <p>ローカル開発では、<a href="https://ngrok.com/">ngrok</a>のようなプロキシサービスを使って公開 URL を作成し、リクエストを開発環境にトンネリングすることができます。このトンネリングの方法については、<a href="https://ngrok.com/docs#getting-started-expose">ngrok のガイド</a>を参照してください。</p>
</blockquote>

<p>最後に、聞きたいイベントをSlackに伝えましょう。<strong>Event Subscriptions</strong>の下にある、<strong>Enable Events</strong>というラベルの付いたスイッチを切り替えます。</p>

<p>イベントが発生すると、Slack は、そのイベントをトリガーしたユーザーやイベントが発生したチャンネルなど、イベントに関する情報をアプリに送信します。アプリが詳細を処理し、それに応じて応答することができます。</p>

<p><strong>Request URL</strong>  ボックスの  <strong>Enable Events</strong>  スイッチの下のフィールドにこの URL を貼り付けます。Bolt アプリが引き続き実行されている場合は、URL が検証されチェックマークが表示されます。</p>

<p>Request URL が検証されたら、<strong>Subscribe to Bot Events</strong> までスクロールします。メッセージに関するイベントが４つあります:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">message.channels</code> あなたのアプリが追加されているパブリックチャンネルのメッセージをリッスン</li>
  <li><code class="language-plaintext highlighter-rouge">message.groups</code> あなたのアプリが追加されている🔒プライベートチャンネルのメッセージをリッスン</li>
  <li><code class="language-plaintext highlighter-rouge">message.im</code> あなたのアプリとユーザーのダイレクトメッセージをリッスン</li>
  <li><code class="language-plaintext highlighter-rouge">message.mpim</code> あなたのアプリが追加されているグループ DM をリッスン</li>
</ul>

<p>もしボットに参加しているすべての場所で全てのメッセージイベントをリッスンさせたいなら、これら４つ全てのイベントを選んでください。選択したら、緑の <strong>Save Changes</strong> ボタンをクリックします。</p>

<hr />

<h3 id="listening-and-responding-to-a-message">メッセージのリスニングと応答</h3>
<p>これで、アプリでいくつかのロジックを設定する準備が整いました。まずは <code class="language-plaintext highlighter-rouge">message()</code> メソッドを使用して、メッセージのリスナーをアタッチしましょう。</p>

<p>次の例では、あなたのアプリが追加されているチャンネルや DM で <code class="language-plaintext highlighter-rouge">hello</code> という単語を含むすべてのメッセージをリッスンし、 <code class="language-plaintext highlighter-rouge">Hey there @user!</code> と応答します。</p>

<div class="language-javascript highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="kd">const</span> <span class="p">{</span> <span class="nx">App</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">@slack/bolt</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">App</span><span class="p">({</span>
  <span class="na">token</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SLACK_BOT_TOKEN</span><span class="p">,</span>
  <span class="na">signingSecret</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SLACK_SIGNING_SECRET</span>
<span class="p">});</span>

<span class="c1">// "hello" を含むメッセージをリッスンします</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">message</span><span class="p">(</span><span class="dl">'</span><span class="s1">hello</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">({</span> <span class="nx">message</span><span class="p">,</span> <span class="nx">say</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// イベントがトリガーされたチャンネルに say() でメッセージを送信します</span>
  <span class="k">await</span> <span class="nx">say</span><span class="p">(</span><span class="s2">`Hey there &lt;@</span><span class="p">${</span><span class="nx">message</span><span class="p">.</span><span class="nx">user</span><span class="p">}</span><span class="s2">&gt;!`</span><span class="p">);</span>
<span class="p">});</span>

<span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// アプリを起動します</span>
  <span class="k">await</span> <span class="nx">app</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">PORT</span> <span class="o">||</span> <span class="mi">3000</span><span class="p">);</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">⚡️ Bolt app is running!</span><span class="dl">'</span><span class="p">);</span>
<span class="p">})();</span>
</pre></td></tr></tbody></table></code></pre>
  </div>
</div>

<p>アプリを再起動したら、ボットユーザーをチャンネル、 DM に追加し、 <code class="language-plaintext highlighter-rouge">hello</code> を含むメッセージを送信してみてください。アプリが応答したら成功です。</p>

<p>これは基本的な例ですが、ここから自分の好きなようにアプリをカスタマイズしていくことができます。さらにインタラクティブな動作を試すために、プレーンテキストではなくボタンを送信してみましょう。</p>

<hr />

<h3 id="sending-and-responding-to-actions">アクションの送信と応答</h3>

<p>ボタン、選択メニュー、日付ピッカー、モーダルなどの機能を使用するには、インタラクティブ性を有効にする必要があります。イベントと同様に、Slack の URL を指定してアクション ( 「ボタン・クリック」など) を送信する必要があります。</p>

<p>アプリ設定ページに戻り、左側の  <strong>Interactivity &amp; Shortcuts</strong>  をクリックします。<strong>Request URL</strong>  ボックスがもう 1 つあることがわかります。</p>

<blockquote>
  <p>💡 デフォルトでは、Bolt はイベントに使用しているのと同じエンドポイントをインタラクティブコンポーネントに使用するように設定されているため、上記と同じリクエスト URL (この例では <code class="language-plaintext highlighter-rouge">https://8e8ec2d7.ngrok.io/slack/events</code>) を使用します。右下隅にある  <strong>Save Changes</strong>  ボタンを押してください。これでアプリのインタラクティブなコンポーネントを利用する設定が有効になりました!</p>
</blockquote>

<p><img src="../../assets/request-url-config.png" alt="Configuring a Request URL" title="Configuring a Request URL" /></p>

<p>インタラクティブ機能を有効にすると、ショートカット、モーダル、インタラクティブコンポーネント（ボタン、セレクトメニュー、データピッカーなど）とのやり取りがイベントとしてアプリに送信されます。</p>

<p>それでは、アプリのコードに戻り、インタラクティブな処理を追加しましょう。この実装は以下の二つのステップで構成されます。</p>
<ul>
  <li>最初に、アプリからボタンを含むメッセージを送信します。</li>
  <li>次に、ユーザーがボタンをクリックしたときの動作をアプリでリッスンし、応答します。</li>
</ul>

<p>以下は、前のセクションで記述したアプリコードを、文字列だけでなく、ボタン付きのメッセージを送信するように変更したものです。</p>

<div class="language-javascript highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td><td class="rouge-code"><pre><span class="kd">const</span> <span class="p">{</span> <span class="nx">App</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">@slack/bolt</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">App</span><span class="p">({</span>
  <span class="na">token</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SLACK_BOT_TOKEN</span><span class="p">,</span>
  <span class="na">signingSecret</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SLACK_SIGNING_SECRET</span>
<span class="p">});</span>

<span class="c1">// "hello" を含むメッセージをリッスンします</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">message</span><span class="p">(</span><span class="dl">'</span><span class="s1">hello</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">({</span> <span class="nx">message</span><span class="p">,</span> <span class="nx">say</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// イベントがトリガーされたチャンネルに say() でメッセージを送信します</span>
  <span class="k">await</span> <span class="nx">say</span><span class="p">({</span>
    <span class="na">blocks</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="dl">"</span><span class="s2">type</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">section</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
          <span class="dl">"</span><span class="s2">type</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">mrkdwn</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">:</span> <span class="s2">`Hey there &lt;@</span><span class="p">${</span><span class="nx">message</span><span class="p">.</span><span class="nx">user</span><span class="p">}</span><span class="s2">&gt;!`</span>
        <span class="p">},</span>
        <span class="dl">"</span><span class="s2">accessory</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
          <span class="dl">"</span><span class="s2">type</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">button</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">"</span><span class="s2">type</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">plain_text</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Click Me</span><span class="dl">"</span>
          <span class="p">},</span>
          <span class="dl">"</span><span class="s2">action_id</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">button_click</span><span class="dl">"</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="na">text</span><span class="p">:</span> <span class="s2">`Hey there &lt;@</span><span class="p">${</span><span class="nx">message</span><span class="p">.</span><span class="nx">user</span><span class="p">}</span><span class="s2">&gt;!`</span>
  <span class="p">});</span>
<span class="p">});</span>

<span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// アプリを起動します</span>
  <span class="k">await</span> <span class="nx">app</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">PORT</span> <span class="o">||</span> <span class="mi">3000</span><span class="p">);</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">⚡️ Bolt app is running!</span><span class="dl">'</span><span class="p">);</span>
<span class="p">})();</span>
</pre></td></tr></tbody></table></code></pre>
  </div>
</div>

<p><code class="language-plaintext highlighter-rouge">say()</code> に格納されている値が、 <code class="language-plaintext highlighter-rouge">blocks</code> の配列を含むオブジェクトになりました。このブロックは Slack メッセージを構成するコンポーネントであり、テキストや画像、日付ピッカーなど、さまざまなタイプがあります。この例では、アプリは、ボタンを <code class="language-plaintext highlighter-rouge">accessory</code> として含むセクションブロックを使用して応答します。<code class="language-plaintext highlighter-rouge">blocks</code> を使っている場合、 <code class="language-plaintext highlighter-rouge">text</code> は通知やアクセシビリティのためのフォールバックとして使用されます。</p>

<p>このボタン <code class="language-plaintext highlighter-rouge">accessory</code> オブジェクトには、<code class="language-plaintext highlighter-rouge">action_id</code> が割り当てられています。これはボタンの一意の識別子として機能するため、アプリはどのアクションに応答するかを指定できます。</p>

<blockquote>
  <p>💡 <a href="https://app.slack.com/block-kit-builder">Block Kit ビルダー</a>を使うとインタラクティブメッセージを簡単にプロトタイプすることができます。ビルダーを使用すると、ユーザー (またはそのチームメンバー) はメッセージをモックアップして、対応する JSON を生成し、それをアプリに直接貼り付けることができます。</p>
</blockquote>

<p>これで、アプリを再起動し、アプリが登録されているチャンネルで <code class="language-plaintext highlighter-rouge">hello</code> と入力すると、ボタン付きのメッセージが表示されます。ただしこのボタンをクリックしても、まだ何も起こりません。</p>

<p>ボタンがクリックされるとフォローアップメッセージを送信するハンドラーを追加してみましょう。</p>

<div class="language-javascript highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre></td><td class="rouge-code"><pre><span class="kd">const</span> <span class="p">{</span> <span class="nx">App</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">@slack/bolt</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">App</span><span class="p">({</span>
  <span class="na">token</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SLACK_BOT_TOKEN</span><span class="p">,</span>
  <span class="na">signingSecret</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SLACK_SIGNING_SECRET</span>
<span class="p">});</span>

<span class="c1">// "hello" を含むメッセージをリッスンします</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">message</span><span class="p">(</span><span class="dl">'</span><span class="s1">hello</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">({</span> <span class="nx">message</span><span class="p">,</span> <span class="nx">say</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// イベントがトリガーされたチャンネルに say() でメッセージを送信します</span>
  <span class="k">await</span> <span class="nx">say</span><span class="p">({</span>
    <span class="na">blocks</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="dl">"</span><span class="s2">type</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">section</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
          <span class="dl">"</span><span class="s2">type</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">mrkdwn</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">:</span> <span class="s2">`Hey there &lt;@</span><span class="p">${</span><span class="nx">message</span><span class="p">.</span><span class="nx">user</span><span class="p">}</span><span class="s2">&gt;!`</span>
        <span class="p">},</span>
        <span class="dl">"</span><span class="s2">accessory</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
          <span class="dl">"</span><span class="s2">type</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">button</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">"</span><span class="s2">type</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">plain_text</span><span class="dl">"</span><span class="p">,</span>
            <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Click Me</span><span class="dl">"</span>
          <span class="p">},</span>
          <span class="dl">"</span><span class="s2">action_id</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">button_click</span><span class="dl">"</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="na">text</span><span class="p">:</span> <span class="s2">`Hey there &lt;@</span><span class="p">${</span><span class="nx">message</span><span class="p">.</span><span class="nx">user</span><span class="p">}</span><span class="s2">&gt;!`</span>
  <span class="p">});</span>
<span class="p">});</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">action</span><span class="p">(</span><span class="dl">'</span><span class="s1">button_click</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">({</span> <span class="nx">body</span><span class="p">,</span> <span class="nx">ack</span><span class="p">,</span> <span class="nx">say</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// アクションのリクエストを確認</span>
  <span class="k">await</span> <span class="nx">ack</span><span class="p">();</span>
  <span class="k">await</span> <span class="nx">say</span><span class="p">(</span><span class="s2">`&lt;@</span><span class="p">${</span><span class="nx">body</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="s2">&gt; clicked the button`</span><span class="p">);</span>
<span class="p">});</span>

<span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// アプリを起動します</span>
  <span class="k">await</span> <span class="nx">app</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">PORT</span> <span class="o">||</span> <span class="mi">3000</span><span class="p">);</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">⚡️ Bolt app is running!</span><span class="dl">'</span><span class="p">);</span>
<span class="p">})();</span>
</pre></td></tr></tbody></table></code></pre>
  </div>
</div>

<p>このように、<code class="language-plaintext highlighter-rouge">app.action()</code> を使うことで <code class="language-plaintext highlighter-rouge">button_click</code> という <code class="language-plaintext highlighter-rouge">action_id</code> のボタンアクションのリスナーを追加できるのです。アプリを再起動してボタンをクリックしてみましょう。すると、you clicked the button  という新しいメッセージがアプリに表示されるはずです。</p>

<hr />

<h3 id="next-steps">次のステップ</h3>
<p>これで最初の Bolt アプリが構築できました! 🎉</p>

<p>基本的なアプリの作成ができましたので、次回は是非もっといろいろな、 Bolt の機能を使ってアプリを作ってみましょう。下記のリンクを辿っていろいろアイデアを模索してみてください！</p>

<ul>
  <li>
    <p><a href="/bolt-js/ja-jp/concepts#basic">基本的な概念</a>をお読みください。Bolt アプリからアクセスできるさまざまなメソッドと機能について学ぶことができます。</p>
  </li>
  <li>
    <p>ボットが<a href="/bolt-js/ja-jp/concepts#event-listening"><code class="language-plaintext highlighter-rouge">events()</code> メソッド</a>でリッスンできるさまざまなイベントを確認しましょう。イベントはすべて<a href="https://api.slack.com/events">API サイト</a>にリストされています。</p>
  </li>
  <li>
    <p>Bolt を使用すると、アプリにアタッチされているクライアントで <a href="/bolt-js/ja-jp/concepts#web-api">Web API メソッドを呼び出す</a>ことができます。API サイトに <a href="https://api.slack.com/methods">220 を超えるメソッド</a>を用意してあります。</p>
  </li>
  <li>
    <p>異なるトークンの種類については、<a href="https://api.slack.com/docs/token-types">APIサイト</a>を参照してください。アプリケーションが実行したいアクションに応じて、異なるトークンが必要になる場合があります。HTTPではなく<a href="/bolt-js/ja-jp/tutorial/getting-started">Socket Mode</a>を使用している場合は、<code class="language-plaintext highlighter-rouge">connections:write</code>スコープを持つ追加の(<code class="language-plaintext highlighter-rouge">xapp</code>)トークンが必要です。</p>
  </li>
</ul>

        </div>
    </div>

  </div>
  <script src="http://localhost:4000/bolt-js/scripts/tutorial_nav.js"></script>

  
<script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-56978219-13', 'auto');
  ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</body>
</html>