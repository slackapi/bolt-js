<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" >
  
    <title>Slack | Bolt for JavaScript</title>
    <meta name="author" content="Slack">
    <meta name="description" content="A framework that makes Slack app development fast and straight-forward. With a single interface for Slack’s Web API, Events API, and interactive features, Bolt gives you the full power of the Slack platform out of the box.">
    <link rel="canonical" href="http://localhost:4000/bolt-js/tutorial/hubot-migration">
    <link href="https://a.slack-edge.com/17c88/style/rollup-slack_kit_legacy_adapters.css" rel="stylesheet" type="text/css">
    <link href="https://a.slack-edge.com/cc5205/style/rollup-api_site.css" rel="stylesheet" type="text/css">
    
    <link href="http://localhost:4000/bolt-js/assets/style.css" rel="stylesheet" type="text/css">
  
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    

    <!--[if lt IE 9]>
    <script src="https://a.slack-edge.com/ef0d/js/libs/html5shiv.js"></script>
    <![endif]-->
  
    <link id="favicon" rel="shortcut icon" href="http://localhost:4000/bolt-js/assets/bolt-favicon.png" sizes="16x16 32x32 48x48" type="image/png" />
  
  </head>


<body>
  <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KFZ5MK7');</script>
<!-- End Google Tag Manager -->

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KFZ5MK7" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

  <div class="wrapper">
    <div class="panel">
      <div class="sidebar-content">
  <div class="logo">
    <span class="icon">
      <img src="http://localhost:4000/bolt-js/assets/bolt-js-logo.svg">
    </span>

    <span class="name">
      Bolt
    </span>

    <!-- Liquid has no ternary operator, so this is just meant to exclude 
      english sections since they are at the root URL -->
    

    <span class="version">
      
      <a href="https://github.com/slackapi/bolt-js/releases/tag/%40slack/bolt%403.18.0">v3.18.0</a>
    </span>
  </div>

  <ul class="sidebar-section">
    <a href="http://localhost:4000/bolt-js/tutorial/getting-started"><li class="title">Getting started</li></a>
    <a href="http://localhost:4000/bolt-js/reference"><li class="title">Reference</li></a>
  </ul>

  <ul class="sidebar-section">
    <a href="http://localhost:4000/bolt-js/concepts#basic"><li class="title">Basic concepts</li></a>
     
    <a href="http://localhost:4000/bolt-js/concepts#message-listening">
      <li>Listening to messages</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/concepts#message-sending">
      <li>Sending messages</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/concepts#event-listening">
      <li>Listening to events</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/concepts#web-api">
      <li>Using the Web API</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/concepts#action-listening">
      <li>Listening to actions</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/concepts#action-respond">
      <li>Responding to actions</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/concepts#acknowledge">
      <li>Acknowledging requests</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/concepts#shortcuts">
      <li>Listening and responding to shortcuts</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/concepts#commands">
      <li>Listening and responding to commands</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/concepts#creating-modals">
      <li>Opening modals</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/concepts#updating-pushing-views">
      <li>Updating and pushing views</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/concepts#view-submissions">
      <li>Listening to views</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/concepts#publishing-views">
      <li>Publishing views to App Home</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/concepts#options">
      <li>Listening and responding to options</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/concepts#authenticating-oauth">
      <li>Authenticating with OAuth</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/concepts#socket-mode">
      <li>Using Socket Mode</li>
    </a>
    
  </ul>

  <ul class="sidebar-section">
    <a href="http://localhost:4000/bolt-js/concepts#advanced">
      <li class="title">Advanced concepts</li>
    </a>
     
    <a href="http://localhost:4000/bolt-js/concepts#error-handling">
      <li>Handling errors</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/concepts#authorization">
      <li>Authorization</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/concepts#token-rotation">
      <li>Token rotation</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/concepts#conversation-store">
      <li>Conversation stores</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/concepts#global-middleware">
      <li>Global middleware</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/concepts#listener-middleware">
      <li>Listener middleware</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/concepts#context">
      <li>Adding context</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/concepts#deferring-initialization">
      <li>Deferring App initialization</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/concepts#logging">
      <li>Logging</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/concepts#receiver">
      <li>Customizing a receiver</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/concepts#custom-routes">
      <li>Adding Custom HTTP routes</li>
    </a>
    
  </ul>

  
  
    <ul class="sidebar-section"> 
        <li class="title">Deployments</li>
      
        <a href="http://localhost:4000/bolt-js/deployments/aws-lambda">
          <li>AWS Lambda</li>
        </a>
      
        <a href="http://localhost:4000/bolt-js/deployments/heroku">
          <li>Heroku Platform</li>
        </a>
      
    </ul>
  

  <ul class="sidebar-section">
    <a href="http://localhost:4000/bolt-js/concepts#steps">
      <li class="title">
        Workflow steps
        <span class="label-deprecated">
          Deprecated
        </span>
      </li>
    </a>
     
      
    
      
      <a href="http://localhost:4000/bolt-js/concepts#creating-steps">
        
        <!--UNCOMMENT AFTER GA  -->
        <li>
          Creating workflow steps
        </li>
      </a>
      
    
      
      <a href="http://localhost:4000/bolt-js/concepts#adding-editing-steps">
        
        <!--UNCOMMENT AFTER GA  -->
        <li>
          Adding or editing workflow steps
        </li>
      </a>
      
    
      
      <a href="http://localhost:4000/bolt-js/concepts#saving-steps">
        
        <!--UNCOMMENT AFTER GA  -->
        <li>
          Saving step configurations
        </li>
      </a>
      
    
      
      <a href="http://localhost:4000/bolt-js/concepts#executing-steps">
        
        <!--UNCOMMENT AFTER GA  -->
        <li>
          Executing workflow steps
        </li>
      </a>
      
    
  </ul>

  <ul class="sidebar-section">
    
    
    <a href="http://localhost:4000/bolt-js/tutorial/getting-started-http">
      <li class="title">Getting started with HTTP</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/tutorial/hubot-migration">
      <li class="title">Migrating Hubot apps</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/tutorial/migration-v2">
      <li class="title">Migrating to V2</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/tutorial/migration-v3">
      <li class="title">Migrating to V3</li>
    </a>
    
    <a href="http://localhost:4000/bolt-js/tutorial/using-typescript">
      <li class="title">Using TypeScript</li>
    </a>
    
    <a href="https://github.com/SlackAPI/bolt-js/blob/main/.github/contributing.md">
      <li class="title">Contributing</li>
    </a>
  </ul>
</div>

    </div>


    <div class="content">
        <div class="mainheader">
          <div class="header">
  <div class="header_nav">
    <a href="https://github.com/SlackAPI/bolt-js" class="btn header_btn float_right"><ts-icon class="ts_icon_github"></ts-icon>Code on GitHub</a>
    <a href="https://api.slack.com" class="btn header_btn float_right"><ts-icon class="ts_icon_slack_pillow"></ts-icon>Slack Platform Home</a>
    <!-- If we add more languages, this logic will need to change -->
    
      <a href="http://localhost:4000/bolt-js/ja-jp" class="header_btn language-switcher float_right">日本語 (Japanese)</a>
    
    </div>
</div>
        </div>

        <div class="tutorial-nav">
          <ul class="tutorial-nav-list"></ul>
        </div>
        
        <div class="tutorial">
          <h1 id="migrating-apps-from-hubot-to-bolt-for-javascript">Migrating apps from Hubot to Bolt for JavaScript</h1>

<div class="section-content">
  <p>Bolt was created to reduce the time and complexity it takes to build Slack apps. It provides Slack developers a single interface to build using modern features and best practices. This guide is meant to step you through the process of migrating your app from using <a href="https://hubot.github.com/docs/">Hubot</a> to Bolt for JavaScript.</p>

  <p>If you already have an <a href="https://api.slack.com/bot-users#getting-started">app with a bot user</a> or if you’re looking for code samples that translate Hubot code to Bolt for JavaScript code, you may find it valuable to start by reading through the <a href="https://github.com/slackapi/bolt-js/blob/master/examples/hubot-example/script.js">example script in the Bolt for JavaScript repository</a>.</p>
</div>

<hr>

<h3 id="setting-the-stage">Setting the stage</h3>
<p>When translating a Hubot app to Bolt for JavaScript, it’s good to know how each are working behind the scenes. Slack’s Hubot adapter is built to interface with the <a href="https://api.slack.com/rtm">RTM API</a>, which uses a WebSocket-based connection that sends a stream of workspace events to your Hubot app. The RTM API is not recommended for most use cases since it doesn’t include support for newer platform features and it can become very resource-intensive, particularly if the app is installed on multiple or large Slack teams.</p>

<p>The default Bolt for JavaScript receiver is built to support the <a href="https://api.slack.com/events-api">Events API</a>, which uses HTTP-based event subscriptions to send JSON payloads to your Bolt app. The Events API includes newer events that aren’t on RTM and is more granular and scalable. It’s recommended for most use cases, though one reason your app may be stuck using the RTM API could be that the server you’re hosting your app from has a firewall that only allows outgoing requests and not incoming ones.</p>

<p>There are a few other differences you may want to consider before creating a Bolt for JavaScript app:</p>
<ul>
  <li>The minimum version of Node for Bolt for JavaScript is <code class="language-plaintext highlighter-rouge">v10.0.0</code>. If the server you’re hosting your app from cannot support <code class="language-plaintext highlighter-rouge">v10</code>, it’s not possible to migrate your app to Bolt for JavaScript at the moment.</li>
  <li>Bolt for JavaScript doesn’t have support for external scripts. If your Hubot app uses external scripts that are necessary to your app’s functionality or deployment, you probably want to stay with Hubot for now. If you aren’t sure whether your app has any external scripts, you can check the <code class="language-plaintext highlighter-rouge">external-scripts.json</code> file. As we continue to invest in Bolt for JavaScript, we are thinking about the future and how to make development and deployment of Slack apps easier. If there’s a valuable external script that your app uses, we’d love to hear what it is <a href="https://github.com/slackapi/bolt-js/issues/119">in the dedicated GitHub issue</a>.</li>
  <li>Hubot apps are written in Coffeescript, which transpiles into JavaScript. We decided to write Bolt in Typescript to give access to rich type information. Bolt apps can be developed using Typescript or JavaScript. The <a href="https://github.com/slackapi/bolt-js/blob/master/examples/hubot-example/script.js">example script</a> shows you how your Coffeescript may translate to JavaScript. If your app is more than a few simple scripts, it may be worth looking into projects like <a href="https://github.com/decaffeinate/decaffeinate">Decaffeinate</a> to convert your CoffeeScript to JavaScript.</li>
</ul>

<hr>

<h3 id="configuring-your-bot">Configuring your bot</h3>
<p>If you have access to an existing Slack app with a bot user, you can <a href="#configure-what-your-bot-will-hear">jump ahead to the next section</a>. If you aren’t sure, go to your <a href="https://api.slack.com/apps">App Management page</a> and check whether your Hubot app is there. If it is, you can use the credentials from that app (<a href="#configure-what-your-bot-will-hear">go ahead and skip to the next section</a>). Otherwise, we’ll walk you through creating a Slack app.</p>

<h4 id="create-a-slack-app">Create a Slack app</h4>

<p>The first thing you’ll want to do is <a href="https://api.slack.com/apps/new">create a Slack app</a>.</p>

<blockquote>
  <p>💡We recommend using a workspace where you won’t disrupt real work getting done — you can create a new one for free.</p>
</blockquote>

<p>After you fill out your app’s name and pick a workspace to install it to, hit the <code class="language-plaintext highlighter-rouge">Create App</code> button and you’ll land on your app’s <strong>Basic Information</strong> page.</p>

<p>This page contains an overview of your app in addition to important credentials you’ll need later, like the <code class="language-plaintext highlighter-rouge">Signing Secret</code> under the <strong>App Credentials</strong> header.</p>

<p>Look around, add an app icon and description, and then let’s start configuring your app 🔩</p>

<h4 id="add-a-bot-user">Add a bot user</h4>
<p>On Slack, Hubot apps employ bot users which are designed to interact with users in conversation.</p>

<p>To add a bot user to your new app, click <strong>Bot Users</strong> on the left sidebar and then <strong>Add A Bot User</strong>. Give it a display name and username, then click <strong>Add Bot User</strong>. There’s more information about what the different fields are <a href="https://api.slack.com/bot-users#creating-bot-user">on our API site</a>.</p>

<h3 id="configure-what-your-bot-will-hear">Configure what your bot will hear</h3>
<p>The <a href="https://api.slack.com/bot-users#app-mentions-response">Events API</a> is a bot’s equivalent of eyes and ears. It gives a bot a way to react to posted messages, changes to channels, and other activities that happen in Slack.</p>

<blockquote>
  <p>⚠️Before you configure your bot’s events, you’ll need a public URL. If you’ve never created a Bolt for JavaScript app or never used the Events API, it’d be helpful to go through <a href="https://slack.dev/bolt/tutorial/getting-started#setting-up-your-local-project">setting up your local Bolt project</a> and <a href="https://slack.dev/bolt/tutorial/getting-started#setting-up-events">setting up events</a> in the Getting Started guide.</p>
</blockquote>

<h4 id="listening-for-messages">Listening for messages</h4>
<p>All Hubot apps can listen to messages by default, so we need to configure your bot user to do the same.</p>

<p>After walking through <a href="https://slack.dev/bolt/tutorial/getting-started#setting-up-events">setting up events</a>, your Request URL should be verified. Scroll down to <strong>Subscribe to Bot Events</strong>. There are four events related to messages: <code class="language-plaintext highlighter-rouge">message.channels</code> (listens for messages in public channels), <code class="language-plaintext highlighter-rouge">message.groups</code> (listens for messages in private channels), <code class="language-plaintext highlighter-rouge">message.im</code> (listens for messages in the App Home/DM space), and <code class="language-plaintext highlighter-rouge">message.mpim</code> (listens for messages in multi-person DMs).</p>

<p>If you only want your bot to listen to messages in channels, you can listen to <code class="language-plaintext highlighter-rouge">message.channels</code> and <code class="language-plaintext highlighter-rouge">message.groups</code>. Or if you want your bot to listen to messages from everywhere it is, choose all four message events.</p>

<p>After you’ve added the kinds of message events you want your bot to listen to, click <strong>Save Changes</strong>.</p>

<h4 id="listening-for-other-events">Listening for other events</h4>
<p>Your Hubot app may have responded to other events depending on what functionality you used. Look through your script and identify any places where your script uses <code class="language-plaintext highlighter-rouge">react</code>, <code class="language-plaintext highlighter-rouge">respond</code>, or <code class="language-plaintext highlighter-rouge">presenceChange</code>:</p>
<ul>
  <li>If your app uses <code class="language-plaintext highlighter-rouge">respond</code>, subscribe to the <code class="language-plaintext highlighter-rouge">app_mention</code> event. This listens for any time your bot user is mentioned.</li>
  <li>If your app uses <code class="language-plaintext highlighter-rouge">react</code>, subscribe to the <code class="language-plaintext highlighter-rouge">reaction_added</code> event. This listens for any time a reaction is added to a message in channels your bot user is in.</li>
  <li>If your app uses <code class="language-plaintext highlighter-rouge">presenceChange</code>, there is no corresponding event. If this event is important to your bot’s functionality, you may have to continue using Hubot or modify the app’s logic.</li>
</ul>

<blockquote>
  <p>💡An added benefit to Bolt is you can listen to any <a href="https://api.slack.com/events">Events API event</a>. So after you’re done migrating, you can listen to more events like <a href="https://api.slack.com/events/team_join">when a user joins the workspace</a> or <a href="https://api.slack.com/events/app_home_opened">when a user opens a DM with your app</a>.</p>
</blockquote>

<p>After you added events that correspond to your app’s functionality, click <strong>Save Changes</strong>.</p>

<h3 id="changes-to-script-interfaces">Changes to script interfaces</h3>
<p>Bolt’s interface was designed to conform to the Slack API language as much as possible, while Hubot was designed with more generalized language to abstract multiple services. While the interfaces are similar, converting a Hubot script to a Bolt for JavaScript one still requires some code changes.</p>

<p>Bolt for JavaScript doesn’t use <code class="language-plaintext highlighter-rouge">res</code> or expose the raw request from Slack. Instead, you can use the payload body from <code class="language-plaintext highlighter-rouge">payload</code>, or common functionality like sending a message using <code class="language-plaintext highlighter-rouge">say()</code>.</p>

<blockquote>
  <p>⚙️To make it easier, we’ve created a sample script on GitHub that <a href="https://github.com/slackapi/bolt-js/blob/master/examples/hubot-example/script.js">showcases Hubot’s core functionality using equivalent functionality written with Bolt for JavaScript</a>.</p>
</blockquote>

<h4 id="listening-to-patterns-using-message">Listening to patterns using <code class="language-plaintext highlighter-rouge">message()</code>
</h4>
<p>Hubot scripts use <code class="language-plaintext highlighter-rouge">hear()</code> listen to messages with a matching pattern. Bolt for JavaScript instead uses <code class="language-plaintext highlighter-rouge">message()</code> and accepts a <code class="language-plaintext highlighter-rouge">string</code> or <code class="language-plaintext highlighter-rouge">RegExp</code> for the pattern.</p>

<blockquote>
  <p>👨‍💻👩‍💻Anywhere where you use <code class="language-plaintext highlighter-rouge">hear()</code> in your code, change it to use <code class="language-plaintext highlighter-rouge">message()</code></p>
</blockquote>

<p><a href="https://slack.dev/bolt/concepts#message-listening">Read more about listening to messages</a>.</p>

<h4 id="responding-with-a-message-using-say-and-respond">Responding with a message using <code class="language-plaintext highlighter-rouge">say()</code> and <code class="language-plaintext highlighter-rouge">respond()</code>
</h4>
<p>Hubot scripts use <code class="language-plaintext highlighter-rouge">send()</code> to send a message to the same conversation and <code class="language-plaintext highlighter-rouge">reply()</code> to send a message to the same conversation with an @-mention to the user that sent the original message.</p>

<p>Bolt for JavaScript uses <code class="language-plaintext highlighter-rouge">await say()</code> in place of <code class="language-plaintext highlighter-rouge">send()</code>, or <code class="language-plaintext highlighter-rouge">await respond()</code> to use the <code class="language-plaintext highlighter-rouge">response_url</code> to send a reply. To add an @-mention to the beginning of your reply, you can use the user ID found in the <code class="language-plaintext highlighter-rouge">context</code> object. For example, for a message event you could use <code class="language-plaintext highlighter-rouge">await say('&lt;@${message.user}&gt; Hello :wave:')</code></p>

<p>The arguments for Hubot’s <code class="language-plaintext highlighter-rouge">send()</code> and Bolt for JavaScript’s <code class="language-plaintext highlighter-rouge">say()</code> are mostly the same, although <code class="language-plaintext highlighter-rouge">say()</code> allows you to send messages with <a href="https://api.slack.com/messaging/interactivity#interaction">interactive components like buttons, select menus, and datepickers</a>.</p>

<blockquote>
  <p>👨‍💻👩‍💻Anywhere where you use <code class="language-plaintext highlighter-rouge">send()</code> in your code, change it to use <code class="language-plaintext highlighter-rouge">await say()</code></p>
</blockquote>

<p><a href="https://slack.dev/bolt/concepts#message-sending">Read more about responding to messages</a>.</p>

<h4 id="respond-and-react">
<code class="language-plaintext highlighter-rouge">respond</code> and <code class="language-plaintext highlighter-rouge">react</code>
</h4>

<p>In the previous section, you should have subscribed your app to the <code class="language-plaintext highlighter-rouge">app_mention</code> event if your Hubot script uses <code class="language-plaintext highlighter-rouge">respond()</code>, and <code class="language-plaintext highlighter-rouge">reaction_added</code> if you uses <code class="language-plaintext highlighter-rouge">react()</code>.</p>

<p>Bolt for JavaScript uses a method called <code class="language-plaintext highlighter-rouge">event()</code> that allows you to listen to any <a href="https://api.slack.com/events">Events API event</a>. To change your code, you’ll just change any <code class="language-plaintext highlighter-rouge">respond()</code> to <code class="language-plaintext highlighter-rouge">app.event(‘app_mention’)</code> and any <code class="language-plaintext highlighter-rouge">react()</code> to <code class="language-plaintext highlighter-rouge">app.event(‘reaction_added’)</code>. This is detailed more <a href="https://github.com/slackapi/bolt-js/blob/master/examples/hubot-example/script.js">in the example script</a>.</p>

<blockquote>
  <p>👨‍💻👩‍💻Anywhere where you use <code class="language-plaintext highlighter-rouge">respond()</code> in your code, change it to use <code class="language-plaintext highlighter-rouge">app.event(‘app_mention’)</code>. Anywhere you use <code class="language-plaintext highlighter-rouge">react</code>, change it to <code class="language-plaintext highlighter-rouge">app.event(‘reaction_added’)</code>.</p>
</blockquote>

<p><a href="https://slack.dev/bolt/concepts#event-listening">Read more about listening to events</a>.</p>

<h3 id="using-web-api-methods-with-bolt-for-javascript">Using Web API methods with Bolt for JavaScript</h3>
<p>In Hubot, you needed to import the <code class="language-plaintext highlighter-rouge">WebClient</code> package from <code class="language-plaintext highlighter-rouge">@slack/client</code>. Bolt for JavaScript imports a <code class="language-plaintext highlighter-rouge">WebClient</code> instance for you by default, and exposes it as the <code class="language-plaintext highlighter-rouge">client</code> argument available on all listeners.</p>

<p>To use the built-in <code class="language-plaintext highlighter-rouge">WebClient</code>, you’ll need to pass the token used to instantiate your app or the token associated with the team your request is coming from. This is found on the <code class="language-plaintext highlighter-rouge">context</code> object passed in to your listener functions. For example, to add a reaction to a message, you’d use:</p>

<div class="language-javascript highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td>
<td class="rouge-code"><pre><span class="nx">app</span><span class="p">.</span><span class="nx">message</span><span class="p">(</span><span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">({</span> <span class="nx">message</span><span class="p">,</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">client</span><span class="p">,</span> <span class="nx">logger</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">client</span><span class="p">.</span><span class="nx">reactions</span><span class="p">.</span><span class="nx">add</span><span class="p">({</span>
      <span class="na">token</span><span class="p">:</span> <span class="nx">context</span><span class="p">.</span><span class="nx">botToken</span><span class="p">,</span>
      <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">star</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">channel</span><span class="p">:</span> <span class="nx">message</span><span class="p">.</span><span class="nx">channel</span><span class="p">,</span>
      <span class="na">timestamp</span><span class="p">:</span> <span class="nx">message</span><span class="p">.</span><span class="nx">ts</span><span class="p">,</span>
    <span class="p">});</span>
  <span class="p">}</span>
  <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">logger</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></td>
</tr></tbody></table></code></pre>
  </div>
</div>

<blockquote>
  <p>👨‍💻👩‍💻Change your Web API calls to use one the <code class="language-plaintext highlighter-rouge">client</code> argument.</p>
</blockquote>

<p><a href="https://slack.dev/bolt/concepts#web-api">Read more about using the Web API with Bolt</a>.</p>

<h3 id="using-middleware-with-bolt-for-javascript">Using middleware with Bolt for JavaScript</h3>
<p>Hubot has three kinds of middleware: receive (runs before any listeners are called), listener (runs for every matching listener), and response (runs for every response sent).</p>

<p>Bolt for JavaScript only has two kinds of middleware — global and listener:</p>
<ul>
  <li>Global middleware runs before any listener middleware is called. It’s attached to the Bolt for JavaScript app itself. <a href="https://slack.dev/bolt/concepts#global-middleware">Read more about Bolt for JavaScript’s global middleware</a>.</li>
  <li>Listener middleware only runs for listener functions it’s attached to. <a href="https://slack.dev/bolt/concepts#listener-middleware">Read more about Bolt for JavaScript’s listener middleware</a>.</li>
</ul>

<p>In Bolt for JavaScript, both kinds of middleware must call <code class="language-plaintext highlighter-rouge">await next()</code> to pass control of execution from one middleware to the next. If your middleware encounters an error during execution, you can <code class="language-plaintext highlighter-rouge">throw</code> it and the error will be bubbled up through the previously-executed middleware chain.</p>

<p>To migrate your existing middleware functions, it’s evident that Hubot’s receive middleware aligns with the use case for global middleware in Bolt for JavaScript. And Hubot and Bolt’s listener middleware are nearly the same. To migrate Hubot’s response middleware, wrap Bolt for JavaScript’s <code class="language-plaintext highlighter-rouge">say()</code> or <code class="language-plaintext highlighter-rouge">respond()</code> in your own function, and then call it.</p>

<p>If your middleware needs to perform post-processing of an event, you can call <code class="language-plaintext highlighter-rouge">await next()</code> and any code after will be processed after the downstream middleware has been called.</p>

<h3 id="migrating-the-brain-to-the-conversation-store">Migrating the brain to the conversation store</h3>
<p>Hubot has an in-memory store called the brain. This enables a Hubot script to <code class="language-plaintext highlighter-rouge">get</code> and <code class="language-plaintext highlighter-rouge">set</code> basic pieces of data. Bolt for JavaScript uses a conversation store, which is a global middleware with a <code class="language-plaintext highlighter-rouge">get()</code>/<code class="language-plaintext highlighter-rouge">set()</code> interface.</p>

<p>The default, built-in conversation store uses an in-memory store similar to Hubot, with the ability to set an expiration time in milliseconds. There are two ways to get and set conversation state:</p>
<ul>
  <li>Call <code class="language-plaintext highlighter-rouge">app.convoStore.get()</code> with a conversation ID to retrieve the state of a conversation, and call <code class="language-plaintext highlighter-rouge">app.convoStore.set()</code> with a conversation ID, conversation state (key-value pair), and an optional <code class="language-plaintext highlighter-rouge">expiresAt</code> time in milliseconds.</li>
  <li>In listener middleware, call <code class="language-plaintext highlighter-rouge">context.updateConversation()</code> with the updated conversation state, or use <code class="language-plaintext highlighter-rouge">context.conversation</code> to access the current state of the conversation.</li>
</ul>

<p>If there is more than one instance of your app running, the built-in conversation store will not be shared among the processes so you’ll want to implement a conversation store that fetches conversation state from a database.</p>

<p><a href="https://slack.dev/bolt/concepts#conversation-store">Read more about conversation stores</a>.</p>

<h3 id="next-steps">Next steps</h3>
<p>If you’ve made it this far, it means you’ve likely converted your Hubot app into a Bolt for JavaScript app! ✨⚡</p>

<p>Now that you have your flashy new Bolt for JavaScript app, you can explore how to power it up:</p>
<ul>
  <li>Consider adding interactivity <a href="https://api.slack.com/messaging/interactivity#interaction">like buttons and select menus</a>. These weren’t supported by Hubot and will allow your app to include contextual actions when sending messages to Slack.</li>
  <li>Read <a href="/bolt-js/concepts">the documentation</a> to explore what else is possible with Bolt for JavaScript.</li>
  <li>Check out our <a href="https://glitch.com/~slack-bolt">sample app</a> that shows you how to use events and interactive components.</li>
</ul>

<p>And if you have difficulties while developing, reach out to our developer support team to at <a href="mailto:developers@slack.com">developers@slack.com</a>, and if you run into a problem with the framework <a href="https://github.com/slackapi/bolt-js/issues/new">open an issue on GitHub</a>.</p>

        </div>
    </div>

  </div>
  <script src="http://localhost:4000/bolt-js/scripts/tutorial_nav.js"></script>

  
<script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-56978219-13', 'auto');
  ga('send', 'pageview');
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>

</body>
</html>